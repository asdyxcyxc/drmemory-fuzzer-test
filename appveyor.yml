image: Visual Studio 2017
platform: x86
configuration: Debug

shallow_clone: true
clone_depth: 1

matrix:
  fast_finish: false # set this flag to immediately finish build once one of the jobs fails.

init:
  - ps: 'Write-Host "Configuring VS2017 x86 Native environment:" -ForegroundColor Magenta'
  - cmd: call "C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\Common7\Tools\VsDevCmd.bat"

build: off

before_build:
  - ps: |
      'Write-Host Build worker environment variables: -ForegroundColor Magenta'
      Get-ChildItem Env: | %{"{0}={1}" -f $_.Name,$_.Value}

build_script:
  - ps: 'Write-Host Building $env:APPVEYOR_PROJECT_NAME: -ForegroundColor Magenta'
  - cmd: nmake /f Makefile.nmake

test_script:
  - cmd: .\fuzz_me.exe
